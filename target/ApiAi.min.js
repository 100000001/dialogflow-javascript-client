var ApiAi=function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,t,n){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=12)}([function(e,t){"use strict";var n=this&&this.__extends||function(e,t){function __(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)},r=function(e){function ApiAiBaseError(t){e.call(this,t),this.message=t,this.stack=(new Error).stack}return n(ApiAiBaseError,e),ApiAiBaseError}(Error),i=function(e){function ApiAiClientConfigurationError(t){e.call(this,t),this.name="ApiAiClientConfigurationError"}return n(ApiAiClientConfigurationError,e),ApiAiClientConfigurationError}(r);t.ApiAiClientConfigurationError=i;var o=function(e){function ApiAiRequestError(t,n){e.call(this,t),this.message=t,this.code=n,this.name="ApiAiRequestError"}return n(ApiAiRequestError,e),ApiAiRequestError}(r);t.ApiAiRequestError=o},function(e,t){"use strict";function _resamplerJs(){function Resampler(e,t,n,r,i){this.fromSampleRate=e,this.toSampleRate=t,this.channels=0|n,this.outputBufferSize=r,this.noReturn=!!i,this.initialize()}Resampler.prototype.initialize=function(){if(this.fromSampleRate<=0||this.toSampleRate<=0||this.channels<=0)throw new Error("Invalid settings specified for the resampler.");this.fromSampleRate==this.toSampleRate?(this.resampler=this.bypassResampler,this.ratioWeight=1):(this.resampler=function(e){var t=Math.min(e.length,this.outputBufferSize);if(t%this.channels!=0)throw new Error("Buffer was of incorrect sample length.");if(t<=0)return this.noReturn?0:[];for(var n=0,r=new Array(this.channels),i=0;i<this.channels;++i)r[i]=0;var o=0,s=0,a=!this.tailExists;this.tailExists=!1;var u=this.outputBuffer,c=0,h=0,l=this.ratioWeight;do{if(a)for(n=l,i=0;i<this.channels;++i)r[i]=0;else{for(n=this.lastWeight,i=0;i<this.channels;++i)r[i]=this.lastOutput[i];a=!0}for(;n>0&&o<t;){if(s=1+o-h,!(n>=s)){for(i=0;i<this.channels;++i)r[i]+=e[o+(i>0?i:0)]*n;h+=n,n=0;break}for(i=0;i<this.channels;++i)r[i]+=e[o++]*s;h=o,n-=s}if(0!=n){for(this.lastWeight=n,i=0;i<this.channels;++i)this.lastOutput[i]=r[i];this.tailExists=!0;break}for(i=0;i<this.channels;++i)u[c++]=r[i]/l}while(o<t);return this.bufferSlice(c)},this.ratioWeight=this.fromSampleRate/this.toSampleRate,this.tailExists=!1,this.lastWeight=0,this.initializeBuffers())},Resampler.prototype.bypassResampler=function(e){return this.noReturn?(this.outputBuffer=e,e.length):e},Resampler.prototype.bufferSlice=function(e){if(this.noReturn)return e;try{return this.outputBuffer.subarray(0,e)}catch(t){try{return this.outputBuffer.length=e,this.outputBuffer}catch(t){return this.outputBuffer.slice(0,e)}}},Resampler.prototype.initializeBuffers=function(){try{this.outputBuffer=new Float32Array(this.outputBufferSize),this.lastOutput=new Float32Array(this.channels)}catch(e){this.outputBuffer=[],this.lastOutput=[]}},navigator.Resampler=Resampler}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=_resamplerJs},function(e,t){"use strict";var n=function(){function XhrRequest(){}return XhrRequest.ajax=function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r=null),new Promise(function(i,o){var s=XhrRequest.createXMLHTTPObject(),a=t,u=null;if(n&&e===XhrRequest.Method.GET){a+="?";var c=0;for(var h in n)n.hasOwnProperty(h)&&(c++&&(a+="&"),a+=encodeURIComponent(h)+"="+encodeURIComponent(n[h]))}else n&&(r||(r={}),r["Content-Type"]="application/json",u=JSON.stringify(n));if(s.open(XhrRequest.Method[e],a),r)for(var h in r)r.hasOwnProperty(h)&&s.setRequestHeader(h,r[h]);u?s.send(u):s.send(),s.onload=function(){this.status>=200&&this.status<300?i(this):o(this)},s.onerror=function(){o(this)}})},XhrRequest.get=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),XhrRequest.ajax(XhrRequest.Method.GET,e,t,n)},XhrRequest.post=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),XhrRequest.ajax(XhrRequest.Method.POST,e,t,n)},XhrRequest.put=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),XhrRequest.ajax(XhrRequest.Method.PUT,e,t,n)},XhrRequest["delete"]=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),XhrRequest.ajax(XhrRequest.Method.DELETE,e,t,n)},XhrRequest.createXMLHTTPObject=function(){for(var e=null,t=0;t<XhrRequest.XMLHttpFactories.length;t++){try{e=XhrRequest.XMLHttpFactories[t]()}catch(n){continue}break}return e},XhrRequest}();n.XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];var n;!function(e){!function(e){e[e.GET="GET"]="GET",e[e.POST="POST"]="POST",e[e.PUT="PUT"]="PUT",e[e.DELETE="DELETE"]="DELETE"}(e.Method||(e.Method={}));e.Method}(n||(n={})),Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var r=n(4),i=n(0),o=n(10);t.StreamClient=o["default"];var s=n(6),a=n(2);t.XhrRequest=a["default"];var u=function(){function Client(e){if(!e||!e.accessToken)throw new i.ApiAiClientConfigurationError("Access token is required for new ApiAi.Client instance");this.accessToken=e.accessToken,this.apiLang=e.lang||r["default"].DEFAULT_CLIENT_LANG,this.apiVersion=e.version||r["default"].DEFAULT_API_VERSION,this.apiBaseUrl=e.baseUrl||r["default"].DEFAULT_BASE_URL,this.sessionId=e.sessionId||this.guid()}return Client.prototype.textRequest=function(e,t){if(void 0===t&&(t={}),!e)throw new i.ApiAiClientConfigurationError("Query should not be empty");return t.query=e,new s["default"](this,t).perform()},Client.prototype.createStreamClient=function(e){return void 0===e&&(e={}),e.server=""+r["default"].STREAM_CLIENT_SERVER_PROTO+"://"+r["default"].DEFAULT_STREAM_CLIENT_BASE_URL+":"+r["default"].STREAM_CLIENT_SERVER_PORT+r["default"].STREAM_CLIENT_SERVER_PATH,e.token=this.getAccessToken(),e.sessionId=this.getSessionId(),e.lang=this.getApiLang(),new o["default"](e)},Client.prototype.getAccessToken=function(){return this.accessToken},Client.prototype.getApiVersion=function(){return this.apiVersion?this.apiVersion:r["default"].DEFAULT_API_VERSION},Client.prototype.getApiLang=function(){return this.apiLang?this.apiLang:r["default"].DEFAULT_CLIENT_LANG},Client.prototype.getApiBaseUrl=function(){return this.apiBaseUrl?this.apiBaseUrl:r["default"].DEFAULT_BASE_URL},Client.prototype.setSessionId=function(e){this.sessionId=e},Client.prototype.getSessionId=function(){return this.sessionId},Client.prototype.guid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},Client}();t.Client=u},function(e,t){"use strict";var n;!function(e){!function(e){e[e.EN="en"]="EN",e[e.DE="de"]="DE",e[e.ES="es"]="ES",e[e.PT_BR="pt-BR"]="PT_BR",e[e.ZH_HK="zh-HK"]="ZH_HK",e[e.ZH_CN="zh-CN"]="ZH_CN",e[e.ZH_TW="zh-TW"]="ZH_TW",e[e.NL="nl"]="NL",e[e.FR="fr"]="FR",e[e.IT="it"]="IT",e[e.JA="ja"]="JA",e[e.KO="ko"]="KO",e[e.PT="pt"]="PT",e[e.RU="ru"]="RU",e[e.UK="uk"]="UK"}(e.AVAILABLE_LANGUAGES||(e.AVAILABLE_LANGUAGES={}));var t=e.AVAILABLE_LANGUAGES;e.VERSION="2.0.0",e.DEFAULT_BASE_URL="https://api.api.ai/v1/",e.DEFAULT_STREAM_CLIENT_BASE_URL="api-ws.api.ai/v1/",e.DEFAULT_API_VERSION="20150204",e.DEFAULT_CLIENT_LANG=t.EN,e.STREAM_CLIENT_SERVER_PROTO="wss",e.STREAM_CLIENT_SERVER_PORT="4435",e.STREAM_CLIENT_SERVER_PATH="ws/query"}(n||(n={})),Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var r=n(0),i=n(2),o=function(){function Request(e,t){this.apiAiClient=e,this.options=t,this.uri=this.apiAiClient.getApiBaseUrl()+"query?v="+this.apiAiClient.getApiVersion(),this.requestMethod=i["default"].Method.POST,this.headers={Authorization:"Bearer "+this.apiAiClient.getAccessToken()},this.options.lang=this.apiAiClient.getApiLang(),this.options.sessionId=this.apiAiClient.getSessionId()}return Request.handleSuccess=function(e){return Promise.resolve(JSON.parse(e.responseText))},Request.handleError=function(e){var t=null;try{var n=JSON.parse(e.responseText);t=n.status&&n.status.errorDetails?new r.ApiAiRequestError(n.status.errorDetails,n.status.code):new r.ApiAiRequestError(e.statusText,e.status)}catch(i){t=new r.ApiAiRequestError(e.statusText,e.status)}return Promise.reject(t)},Request.prototype.perform=function(e){void 0===e&&(e=null);var t=e?e:this.options;return i["default"].ajax(this.requestMethod,this.uri,t,this.headers).then(Request.handleSuccess.bind(this))["catch"](Request.handleError.bind(this))},Request}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function __(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)},i=n(5),o=function(e){function TextRequest(){e.apply(this,arguments)}return r(TextRequest,e),TextRequest}(i["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(1),i=n(11),o=function(){function Processors(){}return Processors.bindProcessors=function(){function MagicBuffer(e){this.chunkSize=e,this.array_data=[],this.callback=null}r["default"](),window.AudioContext=window.AudioContext||webkitAudioContext,AudioContext.prototype.createResampleProcessor=function(e,t,n,r){var i=this.createScriptProcessor(e,t,n),o=new navigator.Resampler(this.sampleRate,r,t,e,(!0));return i.onaudioprocess=function(e){for(var t=e.inputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(0),r=o.resampler(t),i=0;i<r;++i)n[i]=o.outputBuffer[i]},i},MagicBuffer.prototype.push=function(e){for(var t=e.length,n=new Array(Math.ceil(t/2)),r=0;r<t;r+=2)n[r/2]=e[r];Array.prototype.push.apply(this.array_data,n),this.process()},MagicBuffer.prototype.process=function(){for(var e;this.array_data.length>this.chunkSize;)e=this.array_data.splice(0,this.chunkSize),this.callback&&this.callback(e)},MagicBuffer.prototype.drop=function(){this.array_data.splice(0,this.array_data.length)},AudioContext.prototype.createEndOfSpeechProcessor=function(e){var t=this.createScriptProcessor(e,1,1);t.endOfSpeechCallback=null;var n=new i["default"];t.vad=n;var r=new MagicBuffer(160);return r.callback=function(e){var i=n.process(e);"CONTINUE"!==i&&t.endOfSpeechCallback&&(t.endOfSpeechCallback(),r.drop())},t.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(0);r.push(t);for(var i=0;i<t.length;i++)n[i]=t[i]},t}},Processors}();t.Processors=o},function(e,t,n){"use strict";var r=n(1),i=n(9),o=function(){function Recorder(e,t){void 0===t&&(t={});var n=t.bufferLen||4096;this.context=e.context,this.node=this.context.createScriptProcessor(n,1,1);var i=new Worker(this._getRecorderWorkerUrl());i.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,resamplerInitializerBody:this._getFunctionBody(r["default"])}});var o,s=!1;this.node.onaudioprocess=function(e){s&&i.postMessage({command:"record",buffer:[e.inputBuffer.getChannelData(0)]})},this.configure=function(e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},this.record=function(){s=!0},this.stop=function(){s=!1},this.clear=function(){i.postMessage({command:"clear"})},this.getBuffer=function(e){o=e||t.callback,i.postMessage({command:"getBuffer"})},this.export16kMono=function(e,n){if(o=e||t.callback,n=n||t.type||"audio/raw",!o)throw new Error("Callback not set");i.postMessage({command:"export16kMono",type:n})},i.onmessage=function(e){o(e.data)},e.connect(this.node),this.node.connect(this.context.destination)}return Recorder.prototype._getRecorderWorkerUrl=function(){var e=window.URL&&URL.createObjectURL.bind(URL);return e(new Blob([this._getFunctionBody(i["default"].createRecorderWorker())],{type:"text/javascript"}))},Recorder.prototype._getFunctionBody=function(e){if("function"!=typeof e)throw new Error("Illegal argument exception: argument is not a funtion: "+e);var t=e.toString(),n=t.indexOf("{"),r=t.lastIndexOf("}");return n>0&&r>0?t.substring(n+1,r):t},Recorder}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t){"use strict";var n=function(){function RecorderWorker(){}return RecorderWorker.createRecorderWorker=function(){return function _recorderWorkerJs(){function init(n){new Function(n.resamplerInitializerBody)(),e=n.sampleRate,t=new navigator.Resampler(e,16e3,1,51200,(!1))}function record(e){r.push(e[0]),n+=e[0].length}function export16kMono(e){var i=mergeBuffers(r,n),o=t.resampler(i),s=encodeRAW(o),a=new Blob([s],{type:e});this.postMessage(a)}function getBuffer(){var e=[];e.push(mergeBuffers(r,n)),this.postMessage(e)}function clear(){n=0,r=[]}function mergeBuffers(e,t){for(var n=new Float32Array(t),r=0,i=0;i<e.length;i++)n.set(e[i],r),r+=e[i].length;return n}function _floatTo16BitPCM(e,t,n){for(var r=0;r<n.length;r++,t+=2){var i=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,i<0?32768*i:32767*i,!0)}}function encodeRAW(e){var t=new ArrayBuffer(2*e.length),n=new DataView(t);return _floatTo16BitPCM(n,0,e),n}var e,t,n=0,r=[];this.onmessage=function(e){switch(e.data.command){case"init":init(e.data.config);break;case"record":record(e.data.buffer);break;case"export16kMono":export16kMono(e.data.type);break;case"getBuffer":getBuffer();break;case"clear":clear()}}}},RecorderWorker}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var r=n(8),i=n(7),o=function(){function StreamClient(e){function _noop(){}void 0===e&&(e={}),i.Processors.bindProcessors(),this.server=e.server||"",this.token=e.token||"",this.sessionId=e.sessionId||"",this.lang=e.lang||"en",this.contentType=e.contentType||StreamClient.CONTENT_TYPE,this.readingInterval=e.readingInterval||StreamClient.INTERVAL,this.onOpen=e.onOpen&&e.onOpen.bind(this)||_noop,this.onClose=e.onClose&&e.onClose.bind(this)||_noop,this.onInit=e.onInit&&e.onInit.bind(this)||_noop,this.onStartListening=e.onStartListening&&e.onStartListening.bind(this)||_noop,this.onStopListening=e.onStopListening&&e.onStopListening.bind(this)||_noop,this.onResults=e.onResults&&e.onResults.bind(this)||_noop,this.onEvent=e.onEvent&&e.onEvent.bind(this)||_noop,this.onError=e.onError&&e.onError.bind(this)||_noop}return StreamClient.prototype.init=function(){var e=this;this.onEvent(StreamClient.Events.MSG_WAITING_MICROPHONE,"Waiting for approval to access your microphone ...");try{window.AudioContext=window.AudioContext||webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,window.URL=window.URL||window.webkitURL,this.audioContext=new AudioContext}catch(t){this.onError(StreamClient.ERROR.ERR_CLIENT,"Error initializing Web Audio browser: "+JSON.stringify(t))}navigator.getUserMedia?navigator.getUserMedia({audio:!0},this.startUserMedia.bind(this,this.onInit),function(t){e.onError(StreamClient.ERROR.ERR_CLIENT,"No live audio input in this browser: "+JSON.stringify(t))}):this.onError(StreamClient.ERROR.ERR_CLIENT,"No user media support")},StreamClient.prototype.startUserMedia=function(e,t){this.mediaStreamSource=this.audioContext.createMediaStreamSource(t),this.userSpeechAnalyser=this.audioContext.createAnalyser(),this.mediaStreamSource.connect(this.userSpeechAnalyser),this.recorder=new r["default"](this.mediaStreamSource),this.onEvent(StreamClient.Events.MSG_INIT_RECORDER,"Recorder initialized"),e&&e()},StreamClient.prototype.isInitialise=function(){return!!this.recorder},StreamClient.prototype.sendJson=function(e){this.socketSend(JSON.stringify(e)),this.socketSend(StreamClient.TAG_END_OF_SENTENCE)},StreamClient.prototype.startListening=function(){var e=this;if(!this.recorder)return void this.onError(StreamClient.ERROR.ERR_AUDIO,"Recorder undefined");if(!this.ws)return void this.onError(StreamClient.ERROR.ERR_AUDIO,"No web socket connection");var t=function(t){e.resampleProcessor=e.audioContext.createResampleProcessor(256,1,1,16e3),e.mediaStreamSource.connect(e.resampleProcessor);var n=e.audioContext.createEndOfSpeechProcessor(256);n.endOfSpeechCallback=t,e.resampleProcessor.connect(n)};t(function(){return e.stopListening()}),this.ws.send("{'timezone':'America/New_York', 'lang':'"+this.lang+"', 'sessionId':'"+this.sessionId+"'}"),this.intervalKey=setInterval(function(){e.recorder.export16kMono(function(t){e.socketSend(t),e.recorder.clear()},"audio/x-raw")},this.readingInterval),this.recorder.record(),this.onStartListening()},StreamClient.prototype.stopListening=function(){var e=this;this.resampleProcessor&&this.resampleProcessor.disconnect(),clearInterval(this.intervalKey);var t=this.recorder;return t?(t.stop(),this.onEvent(StreamClient.Events.MSG_STOP,"Stopped recording"),t.export16kMono(function(n){e.socketSend(n),e.socketSend(StreamClient.TAG_END_OF_SENTENCE),t.clear()},"audio/x-raw"),void this.onStopListening()):void this.onError(StreamClient.ERROR.ERR_AUDIO,"Recorder undefined")},StreamClient.prototype.isOpen=function(){return!!this.ws},StreamClient.prototype.openWebSocket=function(){if(!this.recorder)return void this.onError(StreamClient.ERROR.ERR_AUDIO,"Recorder undefined");this.ws&&this.close();try{this.ws=this.createWebSocket()}catch(e){this.onError(StreamClient.ERROR.ERR_CLIENT,"No web socket support in this browser!")}},StreamClient.prototype.createWebSocket=function(){var e=this,t=this.server+"?"+this.contentType+"&access_token="+this.token,n=new WebSocket(t);return n.onmessage=function(t){var n=t.data;e.onEvent(StreamClient.Events.MSG_WEB_SOCKET,n),n instanceof Object&&!(n instanceof Blob)?e.onError(StreamClient.ERROR.ERR_SERVER,"WebSocket: onEvent: got Object that is not a Blob"):n instanceof Blob?e.onError(StreamClient.ERROR.ERR_SERVER,"WebSocket: got Blob"):e.onResults(JSON.parse(n))},n.onopen=function(t){e.onOpen(),e.onEvent(StreamClient.Events.MSG_WEB_SOCKET_OPEN,t)},n.onclose=function(t){e.onClose(),e.onEvent(StreamClient.Events.MSG_WEB_SOCKET_CLOSE,t.code+"/"+t.reason+"/"+t.wasClean)},n.onerror=function(t){e.onError(StreamClient.ERROR.ERR_NETWORK,JSON.stringify(t.data))},n},StreamClient.prototype.open=function(){this.recorder?this.openWebSocket():this.init()},StreamClient.prototype.close=function(){clearInterval(this.intervalKey),this.recorder&&(this.recorder.stop(),this.recorder.clear(),this.onEvent(StreamClient.Events.MSG_STOP,"Stopped recording")),this.ws&&(this.ws.close(),this.ws=null)},StreamClient.prototype.socketSend=function(e){if(!this.ws)return void this.onError(StreamClient.ERROR.ERR_CLIENT,"No web socket connection: failed to send: "+e);var t=this.ws.readyState;if(1!=t){var n="WebSocket: ";switch(t){case 0:n+="The connection is not yet open.";break;case 2:n+="The connection is in the process of closing.";break;case 3:n+="The connection is closed or couldn't be opened."}n+=" readyState="+t+" (!=1) failed to send: "+e,this.onError(StreamClient.ERROR.ERR_NETWORK,n)}e instanceof Blob?e.size>0?(this.ws.send(e),this.onEvent(StreamClient.Events.MSG_SEND,"Send: blob: "+e.type+", "+e.size)):this.onEvent(StreamClient.Events.MSG_SEND_EMPTY,"Send: blob: "+e.type+", EMPTY"):(this.ws.send(e),this.onEvent(StreamClient.Events.MSG_SEND_EOS_OR_JSON,"Send string: "+e))},StreamClient}();o.CONTENT_TYPE="content-type=audio/x-raw,+layout=(string)interleaved,+rate=(int)16000,+format=(string)S16LE,+channels=(int)1",o.INTERVAL=250,o.TAG_END_OF_SENTENCE="EOS";var o;!function(e){!function(e){e[e.ERR_NETWORK=0]="ERR_NETWORK",e[e.ERR_AUDIO=1]="ERR_AUDIO",e[e.ERR_SERVER=2]="ERR_SERVER",e[e.ERR_CLIENT=3]="ERR_CLIENT"}(e.ERROR||(e.ERROR={}));e.ERROR;!function(e){e[e.MSG_WAITING_MICROPHONE=0]="MSG_WAITING_MICROPHONE",e[e.MSG_MEDIA_STREAM_CREATED=1]="MSG_MEDIA_STREAM_CREATED",e[e.MSG_INIT_RECORDER=2]="MSG_INIT_RECORDER",e[e.MSG_RECORDING=3]="MSG_RECORDING",e[e.MSG_SEND=4]="MSG_SEND",e[e.MSG_SEND_EMPTY=5]="MSG_SEND_EMPTY",e[e.MSG_SEND_EOS_OR_JSON=6]="MSG_SEND_EOS_OR_JSON",e[e.MSG_WEB_SOCKET=7]="MSG_WEB_SOCKET",e[e.MSG_WEB_SOCKET_OPEN=8]="MSG_WEB_SOCKET_OPEN",e[e.MSG_WEB_SOCKET_CLOSE=9]="MSG_WEB_SOCKET_CLOSE",e[e.MSG_STOP=10]="MSG_STOP",e[e.MSG_CONFIG_CHANGED=11]="MSG_CONFIG_CHANGED"}(e.Events||(e.Events={}));e.Events}(o||(o={})),Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t){"use strict";var n=function(){function VAD(){this.reset()}return VAD.prototype.process=function(e){var t=this.frameActive(e);if(this.time=160*this.frameNumber/16e3,t)this.lastActiveTime>=0&&this.time-this.lastActiveTime<this.silenceLengthMilis?(this.sequenceCounter++,this.sequenceCounter>=this.minSequenceCount&&(this.lastSequenceTime=this.time,this.silenceLengthMilis=Math.max(this.minSilenceLengthMilis,this.silenceLengthMilis-(this.maxSilenceLengthMilis-this.minSilenceLengthMilis)/4))):this.sequenceCounter=1,this.lastSequenceTime=this.time;else if(this.time-this.lastSequenceTime>this.silenceLengthMilis)return this.lastSequenceTime>0?"TERMINATE":"NO_SPEECH";return"CONTINUE"},VAD.prototype.frameActive=function(e){for(var t=0,n=0,r=0,i=e.length,o=0;o<i;o++){t+=e[o]*e[o]/160;var s=0;s=e[o]>0?1:-1,0!=r&&s!=r&&n++,r=s}this.frameNumber+=1;var a=!1;return this.frameNumber<this.noiseFrames?(this.noiseEnergy+=t/this.noiseFrames,console.log("noiseEnergy=",this.noiseEnergy)):n>=this.minCZ&&n<=this.maxCZ&&t>Math.max(.01,this.noiseEnergy)*this.energyFactor&&(a=!0),a},VAD.prototype.reset=function(){this.minCZ=5,this.maxCZ=15,this.frameLengthMilis=10,this.maxSilenceLengthMilis=3.5,this.minSilenceLengthMilis=.8,this.silenceLengthMilis=this.maxSilenceLengthMilis,this.sequenceLengthMilis=.03,this.minSequenceCount=3,this.energyFactor=3.1,this.noiseFrames=Math.round(150/this.frameLengthMilis),this.noiseEnergy=0,this.frameNumber=0,this.lastActiveTime=-1,this.lastSequenceTime=0,this.sequenceCounter=0,this.time=0},VAD}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){e.exports=n(3)}]);